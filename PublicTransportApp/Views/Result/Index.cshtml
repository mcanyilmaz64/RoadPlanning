@using System.Linq
@{
    ViewData["Title"] = "Rota Sonuçları";
    
    bool routesAreEqual = false;
    if (ViewBag.TimeBasedRoute != null && ViewBag.CostBasedRoute != null)
    {
        var timeRoute = ViewBag.TimeBasedRoute as List<PublicTransportApp.Models.Stops.Stop>;
        var costRoute = ViewBag.CostBasedRoute as List<PublicTransportApp.Models.Stops.Stop>;
        
        if (timeRoute != null && costRoute != null && timeRoute.Count == costRoute.Count)
        {
            routesAreEqual = true;
            for (int i = 0; i < timeRoute.Count; i++)
            {
                if (timeRoute[i].Id != costRoute[i].Id)
                {
                    routesAreEqual = false;
                    break;
                }
            }
        }
    }
}

<div class="container mt-4">
    <h2>Rota Sonuçları</h2>

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger">
            <i class="fas fa-exclamation-circle"></i>
            @TempData["Error"]
        </div>
        <div class="text-center mt-3">
            <a href="/" class="btn btn-primary">Ana Sayfaya Dön</a>
        </div>
    }
    else if (ViewBag.StartStop != null && ViewBag.EndStop != null)
    {
        <div class="card mb-4">
            <div class="card-header">
                <h4>Başlangıç ve Bitiş Durakları</h4>
            </div>
            <div class="card-body">
                <p><strong>Başlangıç Durağı:</strong> @ViewBag.StartStop.Name</p>
                <p><strong>Bitiş Durağı:</strong> @ViewBag.EndStop.Name</p>
            </div>
        </div>

        @if (ViewBag.TimeBasedRoute != null)
        {
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h4>En Hızlı Rota</h4>
                </div>
                <div class="card-body">
                    <h5>Duraklar:</h5>
                    <ol>
                        @foreach (var stop in ViewBag.TimeBasedRoute)
                        {
                            <li>@stop.Name</li>
                        }
                    </ol>
                    <p class="text-muted">Bu rota, seyahat süresini minimize etmek için optimize edilmiştir.</p>
                </div>
            </div>
        }

        @if (ViewBag.CostBasedRoute != null)
        {
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h4>En Ekonomik Rota</h4>
                </div>
                <div class="card-body">
                    <h5>Duraklar:</h5>
                    <ol>
                        @foreach (var stop in ViewBag.CostBasedRoute)
                        {
                            <li>@stop.Name</li>
                        }
                    </ol>
                    <p class="text-muted">Bu rota, seyahat maliyetini minimize etmek için optimize edilmiştir.</p>
                </div>
            </div>
        }

        @if (routesAreEqual)
        {
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i> 
                En hızlı rota aynı zamanda en ekonomik rotadır!
            </div>
        }

        <div class="text-center mt-3">
            <a href="/" class="btn btn-primary">Yeni Rota Hesapla</a>
        </div>
    }
    else
    {
        <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle"></i>
            Rota hesaplanamadı. Lütfen geçerli başlangıç ve bitiş noktaları seçin.
        </div>
        <div class="text-center mt-3">
            <a href="/" class="btn btn-primary">Ana Sayfaya Dön</a>
        </div>
    }
</div>
